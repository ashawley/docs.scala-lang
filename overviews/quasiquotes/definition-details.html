<!DOCTYPE html>
<html>
  <head>
    <title>Definition and import details | Scala Documentation</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" type="image/png" href="/docs.scala-lang/resources/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="/docs.scala-lang/resources/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/docs.scala-lang/resources/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/docs.scala-lang/resources/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/docs.scala-lang/resources/favicon-16x16.png">
    <link rel="manifest" href="/docs.scala-lang/resources/site.webmanifest">
    <link rel="mask-icon" href="/docs.scala-lang/resources/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#15a9ce">
    <meta name="theme-color" content="#ffffff">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!-- Custom stylesheet -->
    <link href="/docs.scala-lang/resources/css/unslider-dots.css" rel="stylesheet" type="text/css">
    <link href="/docs.scala-lang/resources/css/unslider.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/docs.scala-lang/resources/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="/docs.scala-lang/resources/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/docs.scala-lang/resources/css/monospace.css" type="text/css" />

    <!-- Atom feeds -->
    <link rel="alternate" type="application/atom+xml" title="News Feed" href="http://scala-lang.org/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Feed" href="http://scala-lang.org/feed/blog.xml" />

    <!-- Algolia stylesheet -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


  </head>
  <body>


<div class="navigation-fade-screen"></div>

<header id="site-header">
  <div class="wrap">
    <nav class="navigation" role="menu">
      <a href="http://scala-lang.org" class="navigation-bdand">
        <img src="/docs.scala-lang/resources/img/frontpage/scala-logo-white@2x.png" alt="">
      </a>
      <div class="navigation-panel-button">
        <i class="fa fa-bars"></i>
      </div>
      <ul class="navigation-menu">
        
            <li class="navigation-menu-item">
              <a href="/docs.scala-lang/" class="active">Documentation</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/download/" >Download</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/community/" >Community</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://index.scala-lang.org" >Libraries</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/contribute/" >Contribute</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/blog/" >Blog</a>
            </li>
        
      </ul>
    </nav>
  </div>
</header>
<header id="doc-header">
  <div class="wrap" style="padding: 0px;">
    <nav class="doc-navigation" role="menu">
      <a href="/docs.scala-lang/" class="navigation-bdand">
        <img src="/docs.scala-lang/resources/img/documentation-logo@2x.png" alt="">
      </a>
      <div class="navigation-ellipsis">
        <i class="fa fa-ellipsis-v"></i>
      </div>
      <ul class="navigation-menu">
        
            <li class="navigation-menu-item">
              <a href="#" id="api" >API</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="https://www.scala-lang.org/api/current/">Current</a>
                  </li>
                
                  <li>
                    <a href="https://www.scala-lang.org/files/archive/nightly/2.12.x/api/2.12.x/">Nightly</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/api/all.html">All Versions</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="#" id="learn" >Learn</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="/docs.scala-lang/getting-started.html">Getting Started</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/tour/tour-of-scala.html">Tour of Scala</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/tutorials/scala-for-java-programmers.html">Scala for Java Programmers</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/learn.html">Online Resources</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="#" id="reference" >Reference</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="/docs.scala-lang/overviews/index.html">Guides & Overviews</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/books.html">Books</a>
                  </li>
                
                  <li>
                    <a href="/docs.scala-lang/tutorials/FAQ/index.html">Scala FAQs</a>
                  </li>
                
                  <li>
                    <a href="http://scala-lang.org/files/archive/spec/2.12/">Language Spec</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/docs.scala-lang/style/index.html" id="style guide" >Style Guide</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/docs.scala-lang/cheatsheets/index.html" id="cheatsheet" >Cheatsheet</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/docs.scala-lang/glossary/index.html" id="glossary" >Glossary</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/docs.scala-lang/sips/index.html" id="sips" >SIPs</a>
                
            </li>
        
      </ul>
    </nav>
    <nav class="doc-navigation-submenus">
      
        
          <ul class="navigation-submenu" id="api" style="display: none;">
            
              <li>
                <a href="https://www.scala-lang.org/api/current/">Current</a>
              </li>
            
              <li>
                <a href="https://www.scala-lang.org/files/archive/nightly/2.12.x/api/2.12.x/">Nightly</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/api/all.html">All Versions</a>
              </li>
            
          </ul>
        
      
        
          <ul class="navigation-submenu" id="learn" style="display: none;">
            
              <li>
                <a href="/docs.scala-lang/getting-started.html">Getting Started</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/tour/tour-of-scala.html">Tour of Scala</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/tutorials/scala-for-java-programmers.html">Scala for Java Programmers</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/learn.html">Online Resources</a>
              </li>
            
          </ul>
        
      
        
          <ul class="navigation-submenu" id="reference" style="display: none;">
            
              <li>
                <a href="/docs.scala-lang/overviews/index.html">Guides & Overviews</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/books.html">Books</a>
              </li>
            
              <li>
                <a href="/docs.scala-lang/tutorials/FAQ/index.html">Scala FAQs</a>
              </li>
            
              <li>
                <a href="http://scala-lang.org/files/archive/spec/2.12/">Language Spec</a>
              </li>
            
          </ul>
        
      
        
      
        
      
        
      
        
      
      <ul class="navigation-submenu ellipsis-menu" style="display: none;">
        
          
        
          
        
          
        
          
            <li><a href="/docs.scala-lang/style/index.html">Style Guide</a></li>
          
        
          
            <li><a href="/docs.scala-lang/cheatsheets/index.html">Cheatsheet</a></li>
          
        
          
            <li><a href="/docs.scala-lang/glossary/index.html">Glossary</a></li>
          
        
          
            <li><a href="/docs.scala-lang/sips/index.html">SIPs</a></li>
          
        
      </ul>
    </nav>
  </div>
</header>


<main id="inner-main">

  <!-- Title -->
  <section class="title-page">
    <div class="wrap">
      <div class="content-title-documentation">
        <div class="titles">
          
            <div class="supertitle">Quasiquotes</div>
          
          <h1>Definition and import details</h1>
        </div>
        <div class="language-dropdown">
          <div id="dd" class="wrapper-dropdown" tabindex="1">
            <span>Language</span>
              <ul class="dropdown"></ul>
          </div>
      </div>
    </div>
  </section>

  
  <section class="content">
	<div class="wrap">
		<div class="content-primary documentation">
			<div class="inner-box">
				<div class="toc-context">
					<p><strong>Denys Shabalin</strong> <span class="tag" style="float: right;">EXPERIMENTAL</span></p>

<h2 id="modifiers">Modifiers</h2>

<p>Every definition except packages and package objects have associated a modifiers object that contains the following data:</p>

<ol>
  <li><code class="highlighter-rouge">FlagSet</code>, a set of bits that characterizes the given definition.</li>
  <li>Private within name (e.g. <code class="highlighter-rouge">foo</code> in <code class="highlighter-rouge">private[foo] def f</code>).</li>
  <li>A list of annotations.</li>
</ol>

<p>Quasiquotes let you work easily with those fields through native support for <code class="highlighter-rouge">Modifiers</code>, <code class="highlighter-rouge">FlagSet</code> and annotation unquoting:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val f1 = q"${Modifiers(PRIVATE | IMPLICIT)} def f"
f1: universe.DefDef = implicit private def f: scala.Unit

scala&gt; val f2 = q"$PRIVATE $IMPLICIT def f"
f2: universe.DefDef = implicit private def f: scala.Unit

scala&gt; val f3 = q"private implicit def f"
f3: universe.DefDef = implicit private def f: scala.Unit
</code></pre></div></div>

<p>All of those quasiquotes result in equivalent trees. It’s also possible to combine unquoted flags with one provided inline in the source code, but an unquoted one should be used before inline ones:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; q"$PRIVATE implicit def foo"
res10: universe.DefDef = implicit private def foo: scala.Unit

scala&gt; q"implicit $PRIVATE def foo"
&lt;console&gt;:32: error: expected start of definition
              q"implicit $PRIVATE def foo"
                         ^
</code></pre></div></div>

<p>To provide a definition annotation one must unquote a new-shaped tree:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val annot = q"new foo(1)"
annot: universe.Tree = new Foo(1)

scala&gt; val f4 = q"@$annot def f"
f4: universe.DefDef = @new foo(1) def f: scala.Unit

scala&gt; val f5 = q"@foo(1) def f"
f5: universe.DefDef = @new foo(1) def f: scala.Unit
</code></pre></div></div>

<p>In deconstruction one can either extract <code class="highlighter-rouge">Modifiers</code> or annotations, but you can’t extract flags separately:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods def f" = q"@foo implicit def f"
mods: universe.Modifiers = Modifiers(&lt;deferred&gt; implicit, , Map())

scala&gt; val q"@..$annots implicit def f" = q"@foo @bar implicit def f"
annots: List[universe.Tree] = List(new foo(), new bar())
</code></pre></div></div>

<p>Considering that definitions might contain various low-level flags added to trees during typechecking, it's recommended to always extract complete modifiers, or your pattern might not be exhaustive. If you don’t care about them just use a wildcard:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$_ def f" = q"@foo @bar implicit def f"
</code></pre></div></div>

<h2 id="templates">Templates</h2>

<p>Templates are a common abstraction in definition trees that are used in new expressions, classes, traits, objects, and package objects. Although there is no interpolator for it at the moment we can illustrate its structure using the example of a new expression (similar handling will apply to all other template-bearing trees):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"new { ..$earlydefns } with ..$parents { $self =&gt; ..$stats }"
</code></pre></div></div>

<p>The template consists of:</p>

<ol>
  <li>
    <p>Early definitions. A list of <code class="highlighter-rouge">val</code> or <code class="highlighter-rouge">type</code> definitions. Type definitions are still allowed by they are deprecated and will be removed in the future:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val withx = q"new { val x = 1 } with RequiresX"
 withx: universe.Tree = ...

 scala&gt; val q"new { ..$earlydefns } with RequiresX" = withx
 earlydefns: List[universe.Tree] = List(val x = 1)
</code></pre></div>    </div>
  </li>
  <li>
    <p>List of parents. A list of type identifiers where only the first one in the list may have optional type and value arguments.  This is because the first parent must be a class and subsequent parents are just traits that don’t yet accept arguments:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val q"new ..$parents"  = q"new Foo(1) with Bar[T]"
 parents: List[universe.Tree] = List(Foo(1), Bar[T])
</code></pre></div>    </div>

    <p>The first of the parents has an unusual shape that is a combination of term and type trees:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val q"${tq"$name[..$targs]"}(...$argss)" = parents.head
 name: universe.Tree = Foo
 targs: List[universe.Tree] = List()
 argss: List[List[universe.Tree]] = List(List(1))
</code></pre></div>    </div>

    <p>The others are just plain type trees:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val tq"$name[..$targs]" = parents.tail.head
 name: universe.Tree = Bar
 targs: List[universe.Tree] = List(T)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Self type definition. A <code class="highlighter-rouge">val</code> definition that can be used to define an alias to <code class="highlighter-rouge">this</code> and provide a self-type via <code class="highlighter-rouge">tpt</code>:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val q"new { $self =&gt; }" = q"new { self: T =&gt; }"
 self: universe.ValDef = private val self: T = _

 scala&gt; val q"$mods val $name: $tpt" = self
 mods: universe.Modifiers = Modifiers(private, , Map())
 name: universe.TermName = self
 tpt: universe.Tree = T
</code></pre></div>    </div>
  </li>
  <li>
    <p>List of body statements.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val q"new { ..$body }" = q"new { val x = 1; def y = 'y }"
 body: List[universe.Tree] = List(val x = 1, def y = scala.Symbol("y"))
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="val-and-var-definitions">Val and Var Definitions</h2>

<p><code class="highlighter-rouge">val</code>s and <code class="highlighter-rouge">var</code>s allow you to define immutable values and mutable variables respectively. Additionally they can be used to represent <a href="expression-details.html#function">function</a>, <a href="#class-definition">class</a> and <a href="#method-definition">method</a> parameters.</p>

<p>Each <code class="highlighter-rouge">val</code> and <code class="highlighter-rouge">var</code> consistents of four components: modifiers, a name, a type tree and a right hand side:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val valx = q"val x = 2"
valx: universe.ValDef = val x = 2

scala&gt; val q"$mods val $name: $tpt = $rhs" = valx
mods: universe.Modifiers = Modifiers(, , Map())
name: universe.TermName = x
tpt: universe.Tree = &lt;type ?&gt;
rhs: universe.Tree = 2
</code></pre></div></div>

<p>If the type of the <code class="highlighter-rouge">val</code> isn’t explicitly specified by the user an <a href="type-details.html#empty-type">empty type</a> is used as <code class="highlighter-rouge">tpt</code>.</p>

<p><code class="highlighter-rouge">val</code>s and <code class="highlighter-rouge">var</code>s are disjoint (they don’t match one another):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods val $name: $tpt = $rhs" = q"var x = 2"
scala.MatchError: var x = 2 (of class scala.reflect.internal.Trees$ValDef)
  ... 32 elided
</code></pre></div></div>

<p>Vars always have the <code class="highlighter-rouge">MUTABLE</code> flag in their modifiers:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods var $name: $tpt = $rhs" = q"var x = 2"
mods: universe.Modifiers = Modifiers(&lt;mutable&gt;, , Map())
name: universe.TermName = x
tpt: universe.Tree = &lt;type ?&gt;
rhs: universe.Tree = 2
</code></pre></div></div>

<h2 id="pattern-definitions">Pattern Definitions</h2>

<p>Pattern definitions allow you to use Scala pattern matching capabilities to define variables. Unlike <code class="highlighter-rouge">val</code> and <code class="highlighter-rouge">var</code> definitions, pattern definitions are not first-class and they are represented through a combination of regular <code class="highlighter-rouge">val</code>s, <code class="highlighter-rouge">var</code>s and pattern matching:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val patdef = q"val (x, y) = (1, 2)"
patdef: universe.Tree =
{
  &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$2 = scala.Tuple2(1, 2): @scala.unchecked match {
    case scala.Tuple2((x @ _), (y @ _)) =&gt; scala.Tuple2(x, y)
  };
  val x = x$2._1;
  val y = x$2._2;
  ()
}
</code></pre></div></div>

<p>This representation has a few side-effects on the usage of such definitions:</p>

<ol>
  <li>
    <p>Due to the fact that a single definition often gets desugared into multiple lower-level
ones, you must always use unquote splicing to unquote pattern definitions into other trees:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val tupsum = q"..$patdef; a + b"
 tupsum: universe.Tree =
 {
   &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$3 = scala.Tuple2(1, 2): @scala.unchecked match {
     case scala.Tuple2((x @ _), (y @ _)) =&gt; scala.Tuple2(x, y)
   };
   val x = x$3._1;
   val y = x$3._2;
   a.$plus(b)
 }
</code></pre></div>    </div>

    <p>Otherwise, if a regular unquoting is used, the definitions will be nested in a block that will make
them invisible in the scope where they are meant to be used:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> scala&gt; val wrongtupsum = q"$patdef; a + b"
 wrongtupsum: universe.Tree =
 {
   {
     &lt;synthetic&gt; &lt;artifact&gt; private[this] val x$3 = scala.Tuple2(1, 2): @scala.unchecked match {
       case scala.Tuple2((x @ _), (y @ _)) =&gt; scala.Tuple2(x, y)
     };
     val x = x$3._1;
     val y = x$3._2;
     ()
   };
   a.$plus(b)
 }
</code></pre></div>    </div>
  </li>
  <li>
    <p>One can only construct pattern definitions, not deconstruct them.</p>
  </li>
</ol>

<p>A generic form of pattern definition consists of modifiers, pattern, ascribed type and a right hand side:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"$mods val $pat: $tpt = $rhs"
</code></pre></div></div>

<p>Similarly, one can also construct a mutable pattern definition:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"$mods var $pat: $tpt = $rhs"
</code></pre></div></div>

<h2 id="type-definition">Type Definition</h2>

<p>Type definitions have two possible shapes: abstract type definitions and alias type definitions.</p>

<p>Abstract type definitions have the following shape:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods type $name[..$tparams] &gt;: $low &lt;: $high" =
           q"type Foo[T] &lt;: List[T]"
mods: universe.Modifiers = Modifiers(&lt;deferred&gt;, , Map())
name: universe.TypeName = Foo
tparams: List[universe.TypeDef] = List(type T)
low: universe.Tree = &lt;empty&gt;
high: universe.Tree = List[T]
</code></pre></div></div>

<p>Whenever one of the bounds isn't available, it gets represented as an <a href="expression-details.html#empty">empty tree</a>. Here each of the type arguments is a type definition itself.</p>

<p>Another form of type definition is a type alias:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods type $name[..$args] = $tpt" =
           q"type Foo[T] = List[T]"
mods: universe.Modifiers = Modifiers(, , Map())
name: universe.TypeName = Foo
args: List[universe.TypeDef] = List(type T)
tpt: universe.Tree = List[T]
</code></pre></div></div>

<p>Due to the low level uniform representation of type aliases and abstract types one matches another:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods type $name[..$args] = $tpt" = q"type Foo[T] &lt;: List[T]"
mods: universe.Modifiers = Modifiers(&lt;deferred&gt;, , Map())
name: universe.TypeName = Foo
args: List[universe.TypeDef] = List(type T)
tpt: universe.Tree =  &lt;: List[T]
</code></pre></div></div>

<p>Where <code class="highlighter-rouge">tpt</code> has a <code class="highlighter-rouge">TypeBoundsTree(low, high)</code> shape.</p>

<h2 id="method-definition">Method Definition</h2>

<p>Each method consists of modifiers, a name, type arguments, value arguments, return type and a body:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods def $name[..$tparams](...$paramss): $tpt = $body" = q"def f = 1"
mods: universe.Modifiers = Modifiers(, , Map())
name: universe.TermName = f
tparams: List[universe.TypeDef] = List()
paramss: List[List[universe.ValDef]] = List()
tpt: universe.Tree = &lt;type ?&gt;
body: universe.Tree = 1
</code></pre></div></div>

<p>Type arguments are <a href="#type-definition">type definitions</a> and value arguments are <a href="#val-and-var-definitions">val definitions</a>. The inferred return type is represented as an <a href="type-details.html#empty-type">empty type</a>. If the body of the method is an <a href="expression-details.html#empty">empty expression</a> it means that method is abstract.</p>

<p>Alternatively you can also deconstruct arguments, separating implicit and non-implicit parameters:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"def g(...$paramss)(implicit ..$implparams) = $body" =
           q"def g(x: Int)(implicit y: Int) = x + y"
paramss: List[List[universe.ValDef]] = List(List(val x: Int = _))
implparams: List[universe.ValDef] = List(implicit val y: Int = _)
body: universe.Tree = x.$plus(y)
</code></pre></div></div>

<p>This way of handling parameters will still work if the method doesn't have any implicit parameters and <code class="highlighter-rouge">implparams</code> will get extracted as an empty list:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"def g(...$paramss)(implicit ..$implparams) = $rhs" =
           q"def g(x: Int)(y: Int) = x + y"
paramss: List[List[universe.ValDef]] = List(List(val x: Int = _), List(val y: Int = _))
implparams: List[universe.ValDef] = List()
body: universe.Tree = x.$plus(y)
</code></pre></div></div>

<h2 id="secondary-constructor-definition">Secondary Constructor Definition</h2>

<p>Secondary constructors are special kinds of methods that have the following shape:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods def this(...$paramss) = this(...$argss)" =
           q"def this() = this(0)"
mods: universe.Modifiers = Modifiers(, , Map())
paramss: List[List[universe.ValDef]] = List(List())
argss: List[List[universe.Tree]] = List(List(0))
</code></pre></div></div>

<p>Due to the low level underlying representation of trees, secondary constructors are represented as a special kind of method with <code class="highlighter-rouge">termNames.CONSTRUCTOR</code> name:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods def $name[..$tparams](...$paramss): $tpt = $body"
         = q"def this() = this(0)"
mods: universe.Modifiers = Modifiers(, , Map())
name: universe.TermName = &lt;init&gt;
tparams: List[universe.TypeDef] = List()
paramss: List[List[universe.ValDef]] = List(List())
tpt: universe.Tree = &lt;type ?&gt;
body: universe.Tree = &lt;init&gt;(0)
</code></pre></div></div>

<h2 id="class-definition">Class Definition</h2>

<p>Classes have the following structure:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"$mods class $tpname[..$tparams] $ctorMods(...$paramss) extends { ..$earlydefns } with ..$parents { $self =&gt; ..$stats }"
</code></pre></div></div>

<p>As you can may already see, the right part after the <code class="highlighter-rouge">extends</code> is just a <a href="#templates">template</a>. Apart from it and the modifiers, classes also have a primary constructor that consists of constructor modifiers, type and value parameters that behave very much like <a href="#method-definition">method</a> modifiers and parameters.</p>

<h2 id="trait-definition">Trait Definition</h2>

<p>Syntactically, traits are quite similar to <a href="#class-definition">classes</a> minus value parameters and constructor modifiers:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> q"$mods trait $tpname[..$tparams] extends { ..$earlydefns } with ..$parents { $self =&gt; ..$stats }"
</code></pre></div></div>

<p>An important difference in handling is caused by <a href="https://issues.scala-lang.org/browse/SI-8399?filter=12305">SI-8399</a> due to the INTERFACE flag that is set for traits. Wwith only abstract members, trait patterns might not match:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"trait $name { ..$stats }" = q"trait X { def x: Int }"
scala.MatchError: ...
</code></pre></div></div>

<p>A workaround is to always extract modifiers using wildcard pattern:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$_ trait $name { ..$stats }" = q"trait X { def x: Int }"
name: universe.TypeName = X
stats: List[universe.Tree] = List(def x: Int)
</code></pre></div></div>

<h2 id="object-definition">Object Definition</h2>

<p>Syntactically, objects are quite similar to <a href="#class-definition">classes</a> without constructors:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"$mods object $tname extends { ..$earlydefns } with ..$parents { $self =&gt; ..$stats }"
</code></pre></div></div>

<h2 id="package-definition">Package Definition</h2>

<p>Packages are a fundamental primitive to organize source code. You can express them in quasiquotes as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="p">&gt;</span> <span class="n">val</span> <span class="n">pack</span> <span class="p">=</span> <span class="n">q</span><span class="s2">"package mycorp.myproj { class MyClass }"</span>
<span class="n">pack</span><span class="p">:</span> <span class="n">universe</span><span class="p">.</span><span class="n">PackageDef</span> <span class="p">=</span>
<span class="k">package</span> <span class="n">mycorp</span><span class="p">.</span><span class="n">myproj</span> <span class="p">{</span>
  <span class="n">class</span> <span class="n">MyClass</span> <span class="n">extends</span> <span class="n">scala</span><span class="p">.</span><span class="n">AnyRef</span> <span class="p">{</span>
    <span class="n">def</span> <span class="p">&lt;</span><span class="n">init</span><span class="p">&gt;()</span> <span class="p">=</span> <span class="p">{</span>
      <span class="n">super</span><span class="p">.&lt;</span><span class="n">init</span><span class="p">&gt;();</span>
      <span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">scala</span><span class="p">&gt;</span> <span class="n">val</span> <span class="n">q</span><span class="s2">"package $ref { ..$body }"</span> <span class="p">=</span> <span class="n">pack</span>
<span class="n">ref</span><span class="p">:</span> <span class="n">universe</span><span class="p">.</span><span class="n">RefTree</span> <span class="p">=</span> <span class="n">mycorp</span><span class="p">.</span><span class="n">myproj</span>
<span class="n">body</span><span class="p">:</span> <span class="k">List</span><span class="p">[</span><span class="n">universe</span><span class="p">.</span><span class="n">Tree</span><span class="p">]</span> <span class="p">=</span>
<span class="k">List</span><span class="p">(</span><span class="n">class</span> <span class="n">MyClass</span> <span class="n">extends</span> <span class="n">scala</span><span class="p">.</span><span class="n">AnyRef</span> <span class="p">{</span>
  <span class="n">def</span> <span class="p">&lt;</span><span class="n">init</span><span class="p">&gt;()</span> <span class="p">=</span> <span class="p">{</span>
    <span class="n">super</span><span class="p">.&lt;</span><span class="n">init</span><span class="p">&gt;();</span>
    <span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Quasiquotes don't support the inline package definition syntax that is usually used in the header of the source file (but it’s equivalent to the supported one in terms of ASTs).</p>

<h2 id="package-object-definition">Package Object Definition</h2>

<p>Package objects are a cross between packages and object:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q"package object $tname extends { ..$earlydefns } with ..$parents { $self =&gt; ..$stats }"
</code></pre></div></div>

<p>All of the handling properties are equivalent to those of objects apart from the fact that they don't have <a href="#modifiers">modifiers</a>.</p>

<p>Even though package and regular objects seem to be quite similar syntactically, they don’t match one another:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scala&gt; val q"$mods object $name" = q"package object O"
scala.MatchError: ...

scala&gt; val q"package object $name" = q"object O"
scala.MatchError: ...
</code></pre></div></div>

<p>Internally, they get represented as an object nested in a package with a given name:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="p">&gt;</span> <span class="n">val</span> <span class="n">P</span> <span class="p">=</span> <span class="n">q</span><span class="s2">"package object P"</span>
<span class="n">P</span><span class="p">:</span> <span class="n">universe</span><span class="p">.</span><span class="n">PackageDef</span> <span class="p">=</span>
<span class="k">package</span> <span class="n">P</span> <span class="p">{</span>
  <span class="n">object</span> <span class="p">`</span><span class="k">package</span><span class="p">`</span> <span class="n">extends</span> <span class="n">scala</span><span class="p">.</span><span class="n">AnyRef</span> <span class="p">{</span>
    <span class="n">def</span> <span class="p">&lt;</span><span class="n">init</span><span class="p">&gt;()</span> <span class="p">=</span> <span class="p">{</span>
      <span class="n">super</span><span class="p">.&lt;</span><span class="n">init</span><span class="p">&gt;();</span>
      <span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This also means that you can match a package object as a package.</p>

				</div>

				<div class="content-contributors">
    <h3>Contributors to this page:</h3>
    <div id="contributors" class="contributors-container"></div>
</div>

			</div>
		</div>

		<!-- TOC -->
		<div class="content-nav">
	<div class="inner-box sidebar-toc-wrapper" style="">
		<h5 class="contents">Contents</h5>
		<div class="inner-toc" id="sidebar-toc">

      <ul>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/setup.html">Dependencies and setup</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/intro.html">Introduction</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/lifting.html">Lifting</a></li>
            
            
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/unlifting.html">Unlifting</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/hygiene.html">Hygiene</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/usecases.html">Use cases</a></li>
            
            
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/syntax-summary.html">Syntax summary</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/expression-details.html">Expression details</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/type-details.html">Type details</a></li>
            
            
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/pattern-details.html">Pattern details</a></li>
            
            
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/definition-details.html">Definition and import details</a></li>
            
            <div id="toc"></div>
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/terminology.html">Terminology summary</a></li>
            
            
          
        
          
        
          
        
          
             <!-- this must be English, so get the other documents' titles -->
            <li><a href="/docs.scala-lang/overviews/quasiquotes/future.html">Future prospects</a></li>
            
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>

      
		</div>
		<hr>
		<div class="help-us"><a href="https://github.com/scala/docs.scala-lang/blob/master/_overviews/quasiquotes/definition-details.md"><i class="fa fa-pencil" aria-hidden="true"></i> Problem with this page?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please help us fix it!</a></div>
	</div>
</div>

	</div>
</section>


</main>

<footer id="site-footer">
    <div class="wrap">
      <div class="site-footer-top">
        
          <ul class="documentation">
            <li><h3>Documentation</h3></li>
            
              <li><a href="/docs.scala-lang/getting-started.html">Getting Started</a></li>
            
              <li><a href="https://www.scala-lang.org/api/current/index.html">API</a></li>
            
              <li><a href="/docs.scala-lang/overviews">Overviews/Guides</a></li>
            
              <li><a href="http://scala-lang.org/files/archive/spec/2.12/">Language Specification</a></li>
            
          </ul>
        
          <ul class="download">
            <li><h3>Download</h3></li>
            
              <li><a href="http://scala-lang.org/download/">Current Version</a></li>
            
              <li><a href="http://scala-lang.org/download/all.html">All versions</a></li>
            
          </ul>
        
          <ul class="community">
            <li><h3>Community</h3></li>
            
              <li><a href="http://scala-lang.org/community/">Community</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#mailing-lists">Mailing Lists</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#chat-rooms">Chat Rooms & More</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#community-libraries-and-tools">Libraries and Tools</a></li>
            
              <li><a href="http://scala.epfl.ch/">The Scala Center</a></li>
            
          </ul>
        
          <ul class="contribute">
            <li><h3>Contribute</h3></li>
            
              <li><a href="http://scala-lang.org/contribute/">How to help</a></li>
            
              <li><a href="http://scala-lang.org/contribute/bug-reporting-guide.html">Report an Issue</a></li>
            
          </ul>
        
          <ul class="scala">
            <li><h3>Scala</h3></li>
            
              <li><a href="http://scala-lang.org/blog/">Blog</a></li>
            
              <li><a href="http://scala-lang.org/conduct/">Code of Conduct</a></li>
            
              <li><a href="http://scala-lang.org/license/">License</a></li>
            
          </ul>
        
          <ul class="social">
            <li><h3>Social</h3></li>
            
              <li><a href="https://github.com/scala/scala">GitHub</a></li>
            
              <li><a href="https://twitter.com/scala_lang">Twitter</a></li>
            
          </ul>
        
      </div>
      <div class="site-footer-bottom">
        <p></p>
        <img src="/docs.scala-lang/resources/img/frontpage/scala-logo-white.png" alt="">
      </div>
    </div>
    <a class="back-to-top in" href="#" id="scroll-to-top-btn">
      <i class="fa fa-angle-up"></i>
    </a>
</footer>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
<script>(window.jQuery) || document.write('<script src="/docs.scala-lang/scripts/jquery-3.1.1.min.js"><\/script>');</script>
<script src="/docs.scala-lang/resources/js/vendor/jquery.autocomplete.js" type="text/javascript"></script>

<!-- moment js -->
<script src="/docs.scala-lang/resources/js/vendor/moment.min.js" type="text/javascript"></script>

<!-- tweet feed -->
<script src="/docs.scala-lang/resources/js/tweetMachine-update.js" type="text/javascript"></script>

<!-- prettify js -->
<script src="/docs.scala-lang/resources/js/vendor/prettify/prettify.js" type="text/javascript"></script>
<script src="/docs.scala-lang/resources/js/vendor/prettify/lang-scala.js" type="text/javascript"></script>

<!-- unslider js -->
<script src="/docs.scala-lang/resources/js/vendor/unslider.js" type="text/javascript"></script>

<!-- Highlight -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/scala.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/java.min.js" type="text/javascript"></script>

<!-- CodeMirror -->
<script src="/docs.scala-lang/resources/js/vendor/codemirror/codemirror.js" type="text/javascript"></script>
<script src="/docs.scala-lang/resources/js/vendor/codemirror/clike.js" type="text/javascript"></script>

<!-- TOC -->
<script src="/docs.scala-lang/resources/js/vendor/jquery.sticky.js" type="text/javascript"></script>
<script src="/docs.scala-lang/resources/js/vendor/toc.js" type="text/javascript"></script>

<!-- Blog search -->
<script src="/docs.scala-lang/resources/js/vendor/jekyll.search.min.js" type="text/javascript"></script>

<!-- Custom javascript -->
<script src="/docs.scala-lang/resources/js/functions.js" type="text/javascript"></script>



<!-- Alogolia search for doc -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: 'fbc439670f5d4e3730cdcb715c359391',
indexName: 'scala-lang',
inputSelector: '#doc-search-bar',
algoliaOptions: { 'facetFilters': ["language:en"] },
debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>

</html>

