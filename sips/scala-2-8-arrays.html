<!DOCTYPE html>
<html>
  <head>
    <title>SID-7 - Scala 2.8 Arrays | Scala Documentation</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" type="image/png" href="/resources/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="/resources/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/resources/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/resources/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/resources/favicon-16x16.png">
    <link rel="manifest" href="/resources/site.webmanifest">
    <link rel="mask-icon" href="/resources/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#15a9ce">
    <meta name="theme-color" content="#ffffff">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!-- Custom stylesheet -->
    <link href="/resources/css/unslider-dots.css" rel="stylesheet" type="text/css">
    <link href="/resources/css/unslider.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/resources/css/highlightjs.css" type="text/css" />
    <link rel="stylesheet" href="/resources/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/resources/css/monospace.css" type="text/css" />

    <!-- Atom feeds -->
    <link rel="alternate" type="application/atom+xml" title="News Feed" href="http://scala-lang.org/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Feed" href="http://scala-lang.org/feed/blog.xml" />

    <!-- Algolia stylesheet -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


  </head>
  <body>


<div class="navigation-fade-screen"></div>

<header id="site-header">
  <div class="wrap">
    <nav class="navigation" role="menu">
      <a href="http://scala-lang.org" class="navigation-bdand">
        <img src="/resources/img/frontpage/scala-logo-white@2x.png" alt="">
      </a>
      <div class="navigation-panel-button">
        <i class="fa fa-bars"></i>
      </div>
      <ul class="navigation-menu">
        
            <li class="navigation-menu-item">
              <a href="/" class="active">Documentation</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/download/" >Download</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/community/" >Community</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://index.scala-lang.org" >Libraries</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/contribute/" >Contribute</a>
            </li>
        
            <li class="navigation-menu-item">
              <a href="https://www.scala-lang.org/blog/" >Blog</a>
            </li>
        
      </ul>
    </nav>
  </div>
</header>
<header id="doc-header">
  <div class="wrap" style="padding: 0px;">
    <nav class="doc-navigation" role="menu">
      <a href="/" class="navigation-bdand">
        <img src="/resources/img/documentation-logo@2x.png" alt="">
      </a>
      <div class="navigation-ellipsis">
        <i class="fa fa-ellipsis-v"></i>
      </div>
      <ul class="navigation-menu">
        
            <li class="navigation-menu-item">
              <a href="#" id="api" >API</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="https://www.scala-lang.org/api/current/">Current</a>
                  </li>
                
                  <li>
                    <a href="https://www.scala-lang.org/files/archive/nightly/2.12.x/api/2.12.x/">Nightly</a>
                  </li>
                
                  <li>
                    <a href="/api/all.html">All Versions</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="#" id="learn" >Learn</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="/getting-started.html">Getting Started</a>
                  </li>
                
                  <li>
                    <a href="/tour/tour-of-scala.html">Tour of Scala</a>
                  </li>
                
                  <li>
                    <a href="/tutorials/scala-for-java-programmers.html">Scala for Java Programmers</a>
                  </li>
                
                  <li>
                    <a href="/learn.html">Online Resources</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="#" id="reference" >Reference</a>
                
                <ul class="navigation-dropdown">
                
                  <li>
                    <a href="/overviews/index.html">Guides & Overviews</a>
                  </li>
                
                  <li>
                    <a href="/books.html">Books</a>
                  </li>
                
                  <li>
                    <a href="/tutorials/FAQ/index.html">Scala FAQs</a>
                  </li>
                
                  <li>
                    <a href="http://scala-lang.org/files/archive/spec/2.12/">Language Spec</a>
                  </li>
                
                </ul>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/style/index.html" id="style guide" >Style Guide</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/cheatsheets/index.html" id="cheatsheet" >Cheatsheet</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/glossary/index.html" id="glossary" >Glossary</a>
                
            </li>
        
            <li class="navigation-menu-item">
              <a href="/sips/index.html" id="sips" >SIPs</a>
                
            </li>
        
      </ul>
    </nav>
    <nav class="doc-navigation-submenus">
      
        
          <ul class="navigation-submenu" id="api" style="display: none;">
            
              <li>
                <a href="https://www.scala-lang.org/api/current/">Current</a>
              </li>
            
              <li>
                <a href="https://www.scala-lang.org/files/archive/nightly/2.12.x/api/2.12.x/">Nightly</a>
              </li>
            
              <li>
                <a href="/api/all.html">All Versions</a>
              </li>
            
          </ul>
        
      
        
          <ul class="navigation-submenu" id="learn" style="display: none;">
            
              <li>
                <a href="/getting-started.html">Getting Started</a>
              </li>
            
              <li>
                <a href="/tour/tour-of-scala.html">Tour of Scala</a>
              </li>
            
              <li>
                <a href="/tutorials/scala-for-java-programmers.html">Scala for Java Programmers</a>
              </li>
            
              <li>
                <a href="/learn.html">Online Resources</a>
              </li>
            
          </ul>
        
      
        
          <ul class="navigation-submenu" id="reference" style="display: none;">
            
              <li>
                <a href="/overviews/index.html">Guides & Overviews</a>
              </li>
            
              <li>
                <a href="/books.html">Books</a>
              </li>
            
              <li>
                <a href="/tutorials/FAQ/index.html">Scala FAQs</a>
              </li>
            
              <li>
                <a href="http://scala-lang.org/files/archive/spec/2.12/">Language Spec</a>
              </li>
            
          </ul>
        
      
        
      
        
      
        
      
        
      
      <ul class="navigation-submenu ellipsis-menu" style="display: none;">
        
          
        
          
        
          
        
          
            <li><a href="/style/index.html">Style Guide</a></li>
          
        
          
            <li><a href="/cheatsheets/index.html">Cheatsheet</a></li>
          
        
          
            <li><a href="/glossary/index.html">Glossary</a></li>
          
        
          
            <li><a href="/sips/index.html">SIPs</a></li>
          
        
      </ul>
    </nav>
  </div>
</header>


<main id="inner-main">

  <!-- Title -->
  <section class="title-page">
    <div class="wrap">
      <div class="content-title-documentation">
        <div class="titles">
          
            <div class="supertitle">&nbsp;</div>
          
          <h1>SID-7 - Scala 2.8 Arrays</h1>
        </div>
        <div class="language-dropdown">
          <div id="dd" class="wrapper-dropdown" tabindex="1">
            <span>Language</span>
              <ul class="dropdown"></ul>
          </div>
      </div>
    </div>
  </section>

  
  <section class="content">
	<div class="wrap">
		<div class="content-primary documentation">
			<div class="inner-box toc-context">
				<p><em>(This is an older SID, its original PDF can be found <a href="http://www.scala-lang.org/sid/7">here</a>)</em></p>

<p><strong>Martin Odersky</strong></p>

<p><em>October 1, 2009</em></p>

<h2 id="the-problem">The Problem</h2>

<p>Arrays have turned out to be one of the trickiest concepts to get right in
Scala. This has mostly to do with very hard constraints that clash with what’s
desirable. On the one hand, we want to use arrays for interoperation with
Java, which means that they need to have the same representation as in Java.
This low-level representation is also useful to get high performance out of
arrays. But on the other hand, arrays in Java are severely limited.</p>

<p>First, there’s actually not a single array type representation in Java but
nine different ones: One representation for arrays of reference type and
another eight for arrays of each of the primitive types <code class="highlighter-rouge">byte</code>, <code class="highlighter-rouge">char</code>,
<code class="highlighter-rouge">short</code>, <code class="highlighter-rouge">int</code>, <code class="highlighter-rouge">long</code>, <code class="highlighter-rouge">float</code>, <code class="highlighter-rouge">double</code>, and <code class="highlighter-rouge">boolean</code>. There is no common
type for these different representations which is more speciﬁc than just
<code class="highlighter-rouge">java.lang.Object</code>, even though there are some reﬂective methods to deal with
arrays of arbitrary type in <code class="highlighter-rouge">java.lang.reflect.Array</code>. Second, there’s no way
to create an array of a generic type; only monomorphic array creations are
allowed. Third, the only operations supported by arrays are indexing, updates,
and get length.</p>

<p>Contrast this with what we would like to have in Scala: Arrays should slot
into the collections hierarchy, supporting the hundred or so methods that are
deﬁned on sequences. And they should certainly be generic, so that one can
create an <code class="highlighter-rouge">Array[T]</code> where <code class="highlighter-rouge">T</code> is a type variable.</p>

<h3 id="the-past">The Past</h3>

<p>How to combine these desirables with the representation restrictions imposed
by Java interoperability and performance? There’s no easy answer, and I
believe we got it wrong the ﬁrst time when we designed Scala. The Scala
language up to 2.7.x “magically” wrapped and unwrapped arrays when required in
a process called boxing and unboxing, similarly to what is done to treat
primitive numeric types as objects. “Magically” means: the compiler generated
code to do so based on the static types of expressions. Additional magic made
generic array creation work. An expression like <code class="highlighter-rouge">new Array[T]</code> where <code class="highlighter-rouge">T</code> is a type
parameter was converted to <code class="highlighter-rouge">new BoxedAnyArray[T]</code>. <code class="highlighter-rouge">BoxedAnyArray</code> was a special
wrapper class which <em>changed its representation</em> depending on the type of the
concrete Java array to which it was cast. This scheme worked well enough for
most programs but the implementation “leaked” for certain combinations of type
tests and type casts, as well as for observing uninitialized arrays. It also
could lead to unexpectedly low performance. Some of the problems have been
described by David MacIver [<a href="http://www.drmaciver.com/2008/06/scala-arrays">1</a>] and Matt Malone [<a href="http://oldfashionedsoftware.com/2009/08/05/the-mystery-of-the-parameterized-array">2</a>].</p>

<p>Boxed arrays were also unsound when combined with covariant collections. In
summary, the old array implementation technique was problematic because it was
a leaky abstraction that was complicated enough so that it would be very
tedious to specify where the leaks were to be expected.</p>

<h3 id="exploring-the-solution-space">Exploring the Solution Space</h3>

<p>The obvious way to reduce the amount of magic needed for arrays is to have two
representations: One which corresponds closely to a Java array and another
which forms an integral part of Scala’s collection hierarchy. Implicit
conversions can be used to transparently convert between the two
representations. This is the gist of the array refactoring proposal of David
MacIver (with contributions by Stepan Koltsov) [[3][3]]. The main problem
with this proposal, as I see it, is that it would force programmers to choose
the kind of array to work with. The choice would not be clear-cut: The Java-
like arrays would be fast and interoperable whereas the Scala native arrays
would support a much nicer set of operations on them. With a choice like this,
one would expect different components and libraries to make different
decisions, which would result in incompatibilities and brittle, complex code.
MacIver and Koltsov introduce some compiler magic to alleviate this. They
propose to automatically split a method taking an array as an argument into
two overloaded versions: one taking a Java array and one taking a generic
Scala array. I believe this would solve some of the more egregious plumbing
issues, but it would simply hide the problem a bit better, not solve it.</p>

<p>A similar idea—- but with a slightly different slant—- is to “dress up” native
arrays with an implicit conversion that integrates them into Scala’s
collection hierarchy. This is similar to what’s been done with the <code class="highlighter-rouge">String</code> to
<code class="highlighter-rouge">RichString</code> conversion in pre-2.8 Scala. The difference to the MacIver/Koltsov
proposal is that one would not normally refer to Scala native arrays in user
code, just as one rarely referred to RichString in Scala. One would only rely
on the implicit conversion to add the necessary methods and traits to Java
arrays. Unfortunately, the String/RichString experience has shown that this is
also problematic. In par- ticular, in pre 2.8 versions of Scala, one had the
non-intuitive property that</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"abc".reverse.reverse == "abc"          //, yet
"abc" != "abc".reverse.reverse          //!
</code></pre></div></div>

<p>The problem here was that the <code class="highlighter-rouge">reverse</code> method was inherited from class <code class="highlighter-rouge">Seq</code>
where it was defined to return another <code class="highlighter-rouge">Seq</code>. Since strings are not sequences,
the only feasible type reverse could return when called on a <code class="highlighter-rouge">String</code> was
<code class="highlighter-rouge">RichString</code>. But then the equals method on <code class="highlighter-rouge">String</code>s which is inherited from
Java would not recognize that a <code class="highlighter-rouge">String</code> could be equal to a <code class="highlighter-rouge">RichString</code>.</p>

<h2 id="28-collections">2.8 Collections</h2>

<p>The new scheme of Scala 2.8 solves the problems with both arrays and strings.
It makes critical use of the new 2.8 collections framework which accompanies
collection traits such as <code class="highlighter-rouge">Seq</code> with implementation traits that abstract over
the representation of the collection. For instance, in addition to trait <code class="highlighter-rouge">Seq</code>
there is now a trait</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trait SeqLike[+Elem, +Repr] { ... }
</code></pre></div></div>

<p>That trait is parameterized with a representation type <code class="highlighter-rouge">Repr</code>. No assumptions
need to be made about this representation type; in particular it not required
to be a subtype of <code class="highlighter-rouge">Seq</code>. Methods such as <code class="highlighter-rouge">reverse</code> in trait <code class="highlighter-rouge">SeqLike</code> will
return values of the representation type <code class="highlighter-rouge">Repr</code> rather than <code class="highlighter-rouge">Seq</code>. The <code class="highlighter-rouge">Seq</code>
trait then inherits all its essential operations from <code class="highlighter-rouge">SeqLike</code>, instantiating
the <code class="highlighter-rouge">Repr</code> parameter to <code class="highlighter-rouge">Seq</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trait Seq[+Elem] extends ... with SeqLike[Elem, Seq[Elem]] { ... }
</code></pre></div></div>

<p>A similar split into base trait and implementation trait applies to most other
kinds of collections, including <code class="highlighter-rouge">Traversable</code>, <code class="highlighter-rouge">Iterable</code>, and <code class="highlighter-rouge">Vector</code>.</p>

<h3 id="integrating-arrays">Integrating Arrays</h3>

<p>We can integrate arrays into this collection framework using two implicit
conversions. The first conversion will map an <code class="highlighter-rouge">Array[T]</code> to an object of type
<code class="highlighter-rouge">ArrayOps</code>, which is a subtype of type <code class="highlighter-rouge">VectorLike[T, Array[T]]</code>. Using this
conversion, all sequence operations are available for arrays at the natural
types. In particular, methods will yield arrays instead of <code class="highlighter-rouge">ArrayOps</code> values as
their results. Because the results of these implicit conversions are so short-
lived, modern VM’s can eliminate them altogether using escape analysis, so we
expect the calling overhead for these added methods to be essentially zero.</p>

<p>So far so good. But what if we need to convert an array to a real <code class="highlighter-rouge">Seq</code>, not
just call a <code class="highlighter-rouge">Seq</code> method on it? For this there is another implicit conversion,
which takes an array and converts it into a <code class="highlighter-rouge">WrappedArray</code>. <code class="highlighter-rouge">WrappedArrays</code>
are mutable <code class="highlighter-rouge">Vectors</code> that implement all vector operations in terms of a given
Java array. The difference between a <code class="highlighter-rouge">WrappedArray</code> and an <code class="highlighter-rouge">ArrayOps</code> object
is apparent in the type of methods like <code class="highlighter-rouge">reverse</code>: Invoked on a
<code class="highlighter-rouge">WrappedArray</code>, reverse returns again a <code class="highlighter-rouge">WrappedArray</code>, but invoked on an
<code class="highlighter-rouge">ArrayOps</code> object, it returns an <code class="highlighter-rouge">Array</code>. The conversion from <code class="highlighter-rouge">Array</code> to
<code class="highlighter-rouge">WrappedArray</code> is invertible. A dual implicit conversion goes from
<code class="highlighter-rouge">WrappedArray</code> to <code class="highlighter-rouge">Array</code>. <code class="highlighter-rouge">WrappedArray</code> and <code class="highlighter-rouge">ArrayOps</code> both inherit from an
implementation trait <code class="highlighter-rouge">ArrayLike</code>. This is to avoid duplication of code between
<code class="highlighter-rouge">ArrayOps</code> and <code class="highlighter-rouge">WrappedArray</code>; all operations are factored out into the common
<code class="highlighter-rouge">ArrayLike</code> trait.</p>

<h3 id="avoiding-ambiguities">Avoiding Ambiguities</h3>

<p>So now that we have two implicit conversions from <code class="highlighter-rouge">Array</code> to <code class="highlighter-rouge">ArrayLike</code>
values, how does one choose between them and how does one avoid ambiguities?
The trick is to make use of a generalization of overloading and implicit
resolution in Scala 2.8. Previously, the most specific overloaded method or
implicit conversion would be chosen based solely on the method’s argument
types. There was an additional clause which said that the most specific method
could not be defined in a proper superclass of any of the other alternatives.
This scheme has been replaced in Scala 2.8 by the following, more liberal one:
When comparing two different applicable alternatives of an overloaded method
or of an implicit, each method gets one point for having more specific
arguments, and another point for being defined in a proper subclass. An
alternative “wins” over another if it gets a greater number of points in these
two comparisons. This means in particular that if alternatives have identical
argument types, the one which is defined in a subclass wins.</p>

<p>Applied to arrays, this means that we can prioritize the conversion from
<code class="highlighter-rouge">Array</code> to <code class="highlighter-rouge">ArrayOps</code> over the conversion from <code class="highlighter-rouge">Array</code> to <code class="highlighter-rouge">WrappedArray</code> by
placing the former in the standard <code class="highlighter-rouge">Predef</code> object and by placing the latter
in a class <code class="highlighter-rouge">LowPriorityImplicits</code>, which is inherited from <code class="highlighter-rouge">Predef</code>. This way,
calling a sequence method will always invoke the conversion to <code class="highlighter-rouge">ArrayOps</code>. The
conversion to <code class="highlighter-rouge">WrappedArray</code> will only be invoked when an array needs to be
converted to a sequence.</p>

<h3 id="integrating-strings">Integrating Strings</h3>

<p>Essentially the same technique is applied to strings. There are two implicit
conversions: The first, which goes from <code class="highlighter-rouge">String</code> to <code class="highlighter-rouge">StringOps</code>, adds useful
methods to class <code class="highlighter-rouge">String</code>. The second, which goes from <code class="highlighter-rouge">String</code> to
<code class="highlighter-rouge">WrappedString</code>, converts strings to sequences.</p>

<h2 id="generic-array-creation-and-manifests">Generic Array Creation and Manifests</h2>

<p>That’s almost everything. The only remaining question is how to implement
generic array creation. Unlike Java, Scala allows an instance creation
<code class="highlighter-rouge">new Array[T]</code> where <code class="highlighter-rouge">T</code> is a type parameter. How can this be implemented, given
the fact that there does not exist a uniform array representation in Java? The
only way to do this is to require additional runtime information which
describes the type <code class="highlighter-rouge">T</code>. Scala 2.8 has a new mechanism for this, which is
called a <code class="highlighter-rouge">Manifest</code>. An object of type <code class="highlighter-rouge">Manifest[T]</code> provides complete
information about the type <code class="highlighter-rouge">T</code>. Manifest values are typically passed in implicit
parameters; and the compiler knows how to construct them for statically
known types <code class="highlighter-rouge">T</code>. There exists also a weaker form named <code class="highlighter-rouge">ClassManifest</code> which can
be constructed from knowing just the top-level class of a type, without
necessarily knowing all its argument types. It is this type of runtime
information that’s required for array creation.</p>

<p>Here’s an example. Consider the method <code class="highlighter-rouge">tabulate</code> which forms an array from
the results of applying a given function <code class="highlighter-rouge">f</code> on a range of numbers from 0
until a given length. Up to Scala 2.7, <code class="highlighter-rouge">tabulate</code> could be written as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def tabulate[T](len: Int, f: Int =&gt; T) = {
	val xs = new Array[T](len)
	for (i &lt;- 0 until len) xs(i) = f(i)
	xs
}
</code></pre></div></div>

<p>In Scala 2.8 this is no longer possible, because runtime information is
necessary to create the right representation of <code class="highlighter-rouge">Array[T]</code>. One needs to
provide this information by passing a <code class="highlighter-rouge">ClassManifest[T]</code> into the method as an
implicit parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def tabulate[T](len: Int, f: Int =&gt; T)(implicit m: ClassManifest[T]) = {
	val xs = new Array[T](len)
	for (i &lt;- 0 until len) xs(i) = f(i)
	xs
}
</code></pre></div></div>

<p>When calling <code class="highlighter-rouge">tabulate</code> on a type such as <code class="highlighter-rouge">Int</code>, or <code class="highlighter-rouge">String</code>, or <code class="highlighter-rouge">List[T]</code>,
the Scala compiler can create a class manifest to pass as implicit argument to
<code class="highlighter-rouge">tabulate</code>. When calling <code class="highlighter-rouge">tabulate</code> on another type parameter, one needs to
propagate the requirement of a class manifest using another implicit parameter
or context bound. For instance:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def tabTen[T: ClassManifest](f: Int =&gt; T) = tabulate(10, f)
</code></pre></div></div>

<p>The move away form boxing and to class manifests is bound to break some
existing code that generated generic arrays as in the first version of
<code class="highlighter-rouge">tabulate</code> above. Usually, the necessary changes simply involve adding a
context bound to some type parameter.</p>

<h3 id="class-genericarray">Class <code class="highlighter-rouge">GenericArray</code></h3>

<p>For the case where generic array creation is needed but adding manifests is
not feasible, Scala 2.8 offers an alternative version of arrays in the
<code class="highlighter-rouge">GenericArray</code> class. This class is defined in package
<code class="highlighter-rouge">scala.collection.mutable</code> along the following lines.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class GenericArray[T](length: Int) extends Vector[T] {
	val array: Array[AnyRef] = new Array[AnyRef](length)
	...
	// all vector operations defined in terms of ‘array’
}
</code></pre></div></div>

<p>Unlike normal arrays, <code class="highlighter-rouge">GenericArrays</code> can be created without a class manifest
because they have a uniform representation: all their elements are stored in
an <code class="highlighter-rouge">Array[AnyRef]</code>, which corresponds to an <code class="highlighter-rouge">Object[]</code> array in Java. The
addition of <code class="highlighter-rouge">GenericArray</code> to the Scala collection library does demand a
choice from the programmer—- should one pick a normal array or a generic
array? This choice is easily answered, however: Whenever a class manifest for
the element type can easily be produced, it’s better to pick a normal array,
because it tends to be faster, is more compact, and has better
interoperability with Java. Only when producing a class manifest is infeasible
one should revert to a <code class="highlighter-rouge">GenericArray</code>. The only place where <code class="highlighter-rouge">GenericArray</code> is
used in Scala’s current collection framework is in the <code class="highlighter-rouge">sortWith</code> method of
class <code class="highlighter-rouge">Seq</code>. A call <code class="highlighter-rouge">xs.sortWith(f)</code> converts its receiver <code class="highlighter-rouge">xs</code> first to a
<code class="highlighter-rouge">GenericArray</code>, passes the resulting array to a Java sorting method defined in
<code class="highlighter-rouge">java.util.Arrays</code>, and converts the sorted array back to the same type of
<code class="highlighter-rouge">Seq</code> as <code class="highlighter-rouge">xs</code>. Since the conversion to an array is a mere implementation
detail of <code class="highlighter-rouge">sortWith</code>, we felt that it was unreasonable to demand a class
manifest for the element type of the sequence. Hence the choice of a
<code class="highlighter-rouge">GenericArray</code>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In summary, the new Scala collection framework resolves some long-standing
problems with arrays and with strings. It removes a considerable amount of
compiler magic and avoids several pitfalls which existed in the previous
implementation. It relies on three new features of the Scala language that
should be generally useful in the construction of libraries and frameworks:
First, the generalization of overloading and implicit resolution allows one to
prioritize some implicits over others. Second, manifests provide type
information at run-time that was lost through erasure. Third, context bounds
are a convenient shorthand for certain forms of implicit arguments. These
three language features will be described in more detail in separate notes.</p>

<h2 id="references">References</h2>
<ol>
  <li><a href="http://www.drmaciver.com/2008/06/scala-arrays">David MacIver. Scala arrays. Blog, June 2008.</a></li>
  <li><a href="http://oldfashionedsoftware.com/2009/08/05/the-mystery-of-the-parameterized-array">Matt Malone. The mystery of the parameterized array. Blog, August 2009.</a></li>
  <li>David MacIver. Refactoring scala.array. Pre-SIP (Scala Improvement Proposal), October 2008.</li>
</ol>


			</div>
		</div>

		<!-- TOC -->
    <div class="content-nav">
    	<div class="inner-box sidebar-toc-wrapper sip-toc" style="">
      
        <h5 class="contents">SIP Committee Decision</h5>
         <div class="tag" style="background-color: #859900">Complete</div>
           <p class="vote-text" style="color: #859900">
             This SIP has already been accepted and completed.
           </p>
        
    		<h5 class="contents">SIP Contents</h5>
    		<div class="inner-toc" id="sidebar-toc">
          <div id="toc"></div>
    		</div>
    		<hr>
    		<div class="help-us"><a href="https://github.com/scala/docs.scala-lang/blob/master/_sips/sips/2010-01-22-scala-2-8-arrays.md"><i class="fa fa-pencil" aria-hidden="true"></i> Problem with this page?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please help us fix it!</a></div>
    	</div>
    </div>

	</div>
</section>


</main>

<footer id="site-footer">
    <div class="wrap">
      <div class="site-footer-top">
        
          <ul class="documentation">
            <li><h3>Documentation</h3></li>
            
              <li><a href="/getting-started.html">Getting Started</a></li>
            
              <li><a href="https://www.scala-lang.org/api/current/index.html">API</a></li>
            
              <li><a href="/overviews">Overviews/Guides</a></li>
            
              <li><a href="http://scala-lang.org/files/archive/spec/2.12/">Language Specification</a></li>
            
          </ul>
        
          <ul class="download">
            <li><h3>Download</h3></li>
            
              <li><a href="http://scala-lang.org/download/">Current Version</a></li>
            
              <li><a href="http://scala-lang.org/download/all.html">All versions</a></li>
            
          </ul>
        
          <ul class="community">
            <li><h3>Community</h3></li>
            
              <li><a href="http://scala-lang.org/community/">Community</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#mailing-lists">Mailing Lists</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#chat-rooms">Chat Rooms & More</a></li>
            
              <li><a href="http://scala-lang.org/community/index.html#community-libraries-and-tools">Libraries and Tools</a></li>
            
              <li><a href="http://scala.epfl.ch/">The Scala Center</a></li>
            
          </ul>
        
          <ul class="contribute">
            <li><h3>Contribute</h3></li>
            
              <li><a href="http://scala-lang.org/contribute/">How to help</a></li>
            
              <li><a href="http://scala-lang.org/contribute/bug-reporting-guide.html">Report an Issue</a></li>
            
          </ul>
        
          <ul class="scala">
            <li><h3>Scala</h3></li>
            
              <li><a href="http://scala-lang.org/blog/">Blog</a></li>
            
              <li><a href="http://scala-lang.org/conduct/">Code of Conduct</a></li>
            
              <li><a href="http://scala-lang.org/license/">License</a></li>
            
          </ul>
        
          <ul class="social">
            <li><h3>Social</h3></li>
            
              <li><a href="https://github.com/scala/scala">GitHub</a></li>
            
              <li><a href="https://twitter.com/scala_lang">Twitter</a></li>
            
          </ul>
        
      </div>
      <div class="site-footer-bottom">
        <p></p>
        <img src="/resources/img/frontpage/scala-logo-white.png" alt="">
      </div>
    </div>
    <a class="back-to-top in" href="#" id="scroll-to-top-btn">
      <i class="fa fa-angle-up"></i>
    </a>
</footer>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
<script>(window.jQuery) || document.write('<script src="/scripts/jquery-3.1.1.min.js"><\/script>');</script>
<script src="/resources/js/vendor/jquery.autocomplete.js" type="text/javascript"></script>

<!-- moment js -->
<script src="/resources/js/vendor/moment.min.js" type="text/javascript"></script>

<!-- tweet feed -->
<script src="/resources/js/tweetMachine-update.js" type="text/javascript"></script>

<!-- prettify js -->
<script src="/resources/js/vendor/prettify/prettify.js" type="text/javascript"></script>
<script src="/resources/js/vendor/prettify/lang-scala.js" type="text/javascript"></script>

<!-- unslider js -->
<script src="/resources/js/vendor/unslider.js" type="text/javascript"></script>

<!-- Highlight -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/scala.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/java.min.js" type="text/javascript"></script>

<!-- CodeMirror -->
<script src="/resources/js/vendor/codemirror/codemirror.js" type="text/javascript"></script>
<script src="/resources/js/vendor/codemirror/clike.js" type="text/javascript"></script>

<!-- TOC -->
<script src="/resources/js/vendor/jquery.sticky.js" type="text/javascript"></script>
<script src="/resources/js/vendor/toc.js" type="text/javascript"></script>

<!-- Blog search -->
<script src="/resources/js/vendor/jekyll.search.min.js" type="text/javascript"></script>

<!-- Custom javascript -->
<script src="/resources/js/functions.js" type="text/javascript"></script>



<!-- Alogolia search for doc -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: 'fbc439670f5d4e3730cdcb715c359391',
indexName: 'scala-lang',
inputSelector: '#doc-search-bar',
algoliaOptions: { 'facetFilters': ["language:en"] },
debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>

</html>

